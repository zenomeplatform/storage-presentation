<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
</head>
<body>

<style>
* {
  transform-style: preserve-3d;
}
</style>

<script type="module">
  import { h, Fragment, render } from 'https://cdn.skypack.dev/preact';
  import { useState, useEffect } from 'https://cdn.skypack.dev/preact/hooks';

  function Block({ x, y, z, ...rest }) {
    const style = { transform: `translate3d(${x}px, ${y}px, ${z}px)` }
    return h("section", { className: "cube", style }, h("div", rest));
  }

  const STYLE_LABEL = { position: "absolute", left: "20%",  bottom: "45%", fontSize: 40, opacity: 0.4 }

  function Many({ Item, amount, getter }) {
      const props = []
      for (let key = 0; key < amount; key++) 
        props.push({ key, ...getter(key) });
      return props.map(props => h(Item, props))
  }

  function NetworkScopeCircle({ offset = 30 }) {
    return h("div", {
      style: { 
        position: "absolute",
        width: "10cm",
        height: "10cm",
        boxShadow: "5px -8px 4px 0 rgba(0,0,255,0.1), inset -5px 8px 4px 0 rgba(0,0,255,0.1)",
        background: "rgba(0,0,0,0)",
        borderRadius: "50%",
        transform: `translate3d(10px, 10px, ${offset}px)`
      },
    })
  }

  function ScopeIcon({ color, text, icon, size, fontSize }) {
    return h(Fragment, {},
        h("div", {  style: { "text-align": "center", color, position: "absolute", inset: 20, fontSize: size }, children: icon }),
        h("div", {  style: { "text-align": "center", color, position: "absolute", left: 20,  right: 20, top: 30 + size, fontSize: fontSize }, children: text }),
    )
  }

  function NetworkScope({ x, y, z, style, children, ...props }) {

    return h("div", {
      ...props,
      style: { 
        position: "absolute",
        width: "10.5cm",
        height: "10.5cm",
        boxShadow: "0px 0px 70px 0 rgba(155,155,155,0.4)",
        //boxShadow: "inset 0 2px 5px 0 rgba(0,0,100,0.6),0 4px 2px 0 rgba(0,0,255,0.19)",
        background: "rgba(240,240,255, 0.9)",
        borderRadius: "50%",
        ...style,
        transform: `translate3d(${x}px, ${y}px, ${z}px)`                 
      },
      children: [
        h(ScopeIcon, { color: "rgba(100,100,255, 1)", text: "P2P NET", 
        icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 31.273 31.273" },
            h("path", { d: "M0 0h24v24H0z", fill: "none" }),
            h("path", { d: `M21.479,8.699H9.93l-0.95,4.307h13.448L21.479,8.699z M14.376,12.412l0.192-0.878h2.269l0.192,0.878H14.376z M21.449,5.784
		V1.609h-4.334h-2.821H9.96v4.175v2.644h11.489V5.784z M20.631,7.744h-9.854V2.426h3.69h2.473h3.691V7.744z M0.95,25.357L0,29.664
		h13.448l-0.95-4.308L0.95,25.357L0.95,25.357z M5.397,29.07l0.193-0.877h2.268l0.193,0.877H5.397z M12.469,22.441v-4.174H8.135
		H5.314H0.98v4.174v2.645h11.489V22.441z M1.797,24.403v-5.317h3.689h2.475h3.688v5.317H1.797z M30.324,25.357H18.773l-0.948,4.307
		h13.448L30.324,25.357z M23.223,29.07l0.192-0.877h2.269l0.193,0.877H23.223z M18.807,22.441v2.645h11.486v-2.645v-4.174H25.96
		h-2.821h-4.332V22.441z M19.623,19.084h3.688h2.476h3.688v5.318h-9.853L19.623,19.084L19.623,19.084z M17.927,21.584l-0.415-0.471
		l0.471-0.416l0.416,0.473L17.927,21.584z M16.572,19.099l0.707,0.8l-0.473,0.417L16.1,19.515L16.572,19.099z M13.157,20.698
		l0.472,0.416l-0.416,0.472l-0.472-0.416L13.157,20.698z M14.57,19.098l0.472,0.416l-0.706,0.8l-0.472-0.416L14.57,19.098z
		 M15.256,15.327h0.627v1.067h-0.627V15.327z M15.256,17.463h0.628v0.979v0.118l-0.136,0.153l-0.179-0.154l-0.177,0.154
		l-0.137-0.153v-0.118L15.256,17.463L15.256,17.463z M15.883,14.259h-0.627v-0.628h0.627V14.259z`, fill: "rgba(100,100,255, 1)" }),
        ), 
        size: 240, fontSize: 40 }),
        h(NetworkScopeCircle, { offset: 20 }),
        h("div", {
          style: { 
            position: "absolute", 
            right: "47%", 
            bottom: "55%" 
          }, children 
        })
      ]
    });
  }


  function LocalScope({ x, y, z, style, size, children, ...props }) {

    return h("div", {
      ...props,
      style: { 
        position: "absolute",
        width: size,
        height: size,
        boxShadow: "0px 0px 70px 0 rgba(155,155,155,0.4), inset 0px 0px 15px 2px rgba(230,230,230,0.6)",
        //boxShadow: "inset 0 2px 5px 0 rgba(0,0,100,0.6),0 4px 2px 0 rgba(0,0,255,0.19)",
        background: "rgba(230,230,230,0.2)",
        borderRadius: "50%",
        border: "1px solid #999",
        ...style,
        transform: `translate3d(${x}px, ${y}px, ${z}px)`
      },
      children: children
    });
  }


  function NetworkNode ({ x, y, z, size = "1cm", style = {} }) {
    return h("div", { 
      style: { 
        position: "absolute",
        width: size,
        height: size,
        boxShadow: "inset 0 2px 5px 0 rgba(0,0,100,0.6),0 4px 2px 0 rgba(0,0,255,0.19)",
        background: "rgba(185,185,255,1)",
        borderRadius: "50%",
        transform: `translate3d(${x}px, ${y}px, ${z}px)`,
        ...style
      }
    });
  }

  function parseOrFallback(value, fallback = 0) {
      const next = parseInt(value)
      if (isNaN(next)) return fallback
      return next;
  }

  const GetCircle = i => ({
    x: -28 + 190 * Math.cos(-2 * Math.PI / 3 + i * Math.PI/10),
    y: 0 + 190 * Math.sin(-2 * Math.PI / 3 + i * Math.PI/10),
    z: 30
  })



  function App (props) {
    const [ pos, setPos ] = useState({ x: 0, y: 0, z: 0, r: 0 });
    const [ isHover, setHover ] = useState(true)

    setTimeout(setHover, 0, false)

    const conElStyle = { 
        boxShadow: "inset 2px 2px 5px 0 rgba(0,0,255,0.3),0 2px 2px 0 rgba(240,240,255,1)", 
        background: "rgba(220,220,220, 0.1)" 
    }

    const myConElStyle = {
        background: "rgba(220,220,255, 0.4)",
        boxShadow: "unset",
    } 

    return h("main", {
      style: {
        width: "800px",
        height: "800px",
        border: "1px solid gray",
        margin: "auto"
      }
    }, [
      h("div", {
        style: {
          transition: "all 1000ms", 
          position: "absolute",
          display: "grid",
          height: "100%",
          width: "100%",
          "align-items": "center",
          "justify-items": "center",
          perspective: "650px",
          transform: `translate(140px, -240px) rotateX(25deg)`
        }
      }, [
        h(NetworkScope, { x: 100, y: -100, z: -290, children: [
              h(Many, { amount: 8, Item: NetworkNode, getter: GetCircle }),
              h(NetworkNode, { x: -150, y: 150, z:  1,  size: "2.5cm", style: myConElStyle }),
              //h(NetworkNode, { x: -150, y: 150, z: -30, size: "2.5cm", style: conElStyle }),
              //h(NetworkNode, { x: -150, y: 150, z: -20, size: "2.5cm", style: conElStyle }),
              //h(NetworkNode, { x: -150, y: 150, z: -10, size: "2.5cm", style: conElStyle })
            ]
        }),
        h(LocalScope, { x: -200, y: 300, z: -299, size: "17cm" }),
        h(LocalScope, { x: -350, y: -80, z: -299, size: "7cm", style: { background: "rgb(240,240,240)" }, 
            children: h(ScopeIcon, {
            color: "rgba(100,100,100, 1)", 
            text: "FUSE-BASED FILESYSTEM", 
            fontSize: 20 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-5 3c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm4 8h-8v-1c0-1.33 2.67-2 4-2s4 .67 4 2v1z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 150 
          })
        }),
        h(LocalScope, { x: -540, y: 80, z: -299, size: "7cm", style: { background: "rgb(240,240,240)" }, 
          children: h(ScopeIcon, {
            color: "rgba(100,100,100, 1)", 
            text: "STORAGE MANAGER", 
            fontSize: 24 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 150 
          })
        }),
        h(LocalScope, { x: -620, y: 320, z: -299, size: "7cm", style: { background: "rgb(240,240,240)" }, 
          children: h(ScopeIcon, {
            color: "rgba(100,100,100, 1)", 
            text: "DATASET SERVICE", 
            fontSize: 24 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 150 
          })
        }),
        h(LocalScope, { x: -540, y: 560, z: -299, size: "7cm", style: { background: "rgb(240,240,240)" }, 
          children: h(ScopeIcon, {
            color: "rgba(100,100,100, 1)", 
            text: "METADATA ENGINE", 
            fontSize: 24 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M19 5v14H5V5h14m1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 150 
          })
        }),
        h(LocalScope, { x: -340, y: 700, z: -299, size: "7cm", style: { background: "rgb(240,240,240)" }, 
          children: h(ScopeIcon, {
            color: "rgba(100,100,100, 1)", 
            text: "RECONCILIATION ENGINE", 
            fontSize: 24 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M9.01,14H2v2h7.01v3L13,15l-3.99-4V14z M14.99,13v-3H22V8h-7.01V5L11,9L14.99,13z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 150 
          })
        }),
        h(LocalScope, { x: -200, y: 300, z: -299, size: "9cm", style: { background: "rgb(245,240,240)" }, 
          children: h(ScopeIcon, { color: "rgba(100,100,100, 1)", text: "USERS MANAGER, CONFIGURATION", 
            fontSize: 24 , 
            icon: h("svg", { height: "150px", width: "150px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z", fill: "rgba(100,100,100, 1)" }),
                  ), 
            size: 200 
          })
        }),

        h(LocalScope, { x:  70, y: 600, z: -299, size: "7cm", 
          style: { background: "rgb(240,250,240)", borderRadius: 20, height: "7cm" }, 
          children: h(ScopeIcon, { color: "rgba(60,60,60, 1)", text: "EXTENSIONS", fontSize: 24 , icon: h("svg", { height: "170px", width: "170px", viewBox: "0 0 24 24" },
                    h("path", { d: "M0 0h24v24H0z", fill: "none" }),
                    h("path", { d: "M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z", fill: "rgba(70,70,70, 1)" }),
                  ), size: 175 })
        }),
        h(Many, { amount: 0, Item: Block, 
            getter(i) {
              return {
                x: pos.x * (1 + i * 0.1),
                y: pos.y * (1 + i * 0.0),
                z: pos.z * (1 + i * 0.1),
                style: {
                  "border-radius": `${pos.r}%`,
                  "padding": "10px", 
                  "background-repeat": "no-repeat",
                  "background-position": "center",
                  "background-size": "contain",
                  "background-image": "url(https://wildbrine.com/wp-content/uploads/2017/08/ncbi.png)" 
                },
                children: "ClinVar"
              }
            } 
          })
      ])
    ])
  }

  render(h(App, { name: "World" }), document.body)
</script>

</body>
</html>